{"version":3,"sources":["static/tts.js"],"names":["playAudio","text","volume","audio","document","createElement","setAttribute","autoplay","addEventListener","pause","removeAttribute","load","remove","getElementById","appendChild","messageQueue","messageQueueNoText","isShowing","socket","io","on","msg","push","window","setInterval","length","$text","$","pop","hide","append","fadeIn","delay","Math","max","split","fadeOut","location","reload"],"mappings":"AAAA,SAASA,SAAT,CAAmBC,IAAnB,EAAyBC,MAAzB,EAAiC;EAC7B,IAAIC,KAAK,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ,CAD6B,CAG7B;;EACAF,KAAK,CAACG,YAAN,CAAmB,KAAnB,EAA0B,+EAA6EL,IAAvG;EACAE,KAAK,CAACG,YAAN,CAAmB,SAAnB,EAA8B,MAA9B;EACAH,KAAK,CAACD,MAAN,GAAeA,MAAf;EACAC,KAAK,CAACI,QAAN,GAAiB,IAAjB;EAEAJ,KAAK,CAACK,gBAAN,CAAuB,OAAvB,EAAgC,YAAW;IACvCL,KAAK,CAACM,KAAN;IACAN,KAAK,CAACO,eAAN,CAAsB,KAAtB;IACAP,KAAK,CAACQ,IAAN;IACAR,KAAK,CAACS,MAAN;EACH,CALD;EAOAR,QAAQ,CAACS,cAAT,CAAwB,MAAxB,EAAgCC,WAAhC,CAA4CX,KAA5C;AACH;;AAED,IAAIY,YAAY,GAAG,EAAnB;AACA,IAAIC,kBAAkB,GAAG,EAAzB;AACA,IAAIC,SAAS,GAAG,KAAhB;AAEA,IAAIC,MAAM,GAAGC,EAAE,EAAf;AACAD,MAAM,CAACE,EAAP,CAAU,SAAV,EAAqB,UAASC,GAAT,EAAc;EAC/BN,YAAY,CAACO,IAAb,CAAkBD,GAAlB;AACH,CAFD;AAGAH,MAAM,CAACE,EAAP,CAAU,gBAAV,EAA4B,UAASC,GAAT,EAAc;EACtCL,kBAAkB,CAACM,IAAnB,CAAwBD,GAAxB;AACH,CAFD;AAIAE,MAAM,CAACC,WAAP,CAAmB,YAAM;EACrB,IAAG,CAACP,SAAD,IAAcF,YAAY,CAACU,MAAb,GAAsB,CAAvC,EAA0C;IACtCR,SAAS,GAAG,IAAZ;IACA,IAAIS,KAAK,GAAGC,CAAC,CAAC,SAAD,CAAb;IACA,IAAI1B,IAAI,GAAGc,YAAY,CAACa,GAAb,EAAX;IACAF,KAAK,CAACzB,IAAN,CAAWA,IAAX;IACAyB,KAAK,CAACG,IAAN;IACAF,CAAC,CAAC,eAAD,CAAD,CAAmBG,MAAnB,CAA0BJ,KAA1B;IACAA,KAAK,CAACK,MAAN,CAAa,GAAb,EAAkBC,KAAlB,CAAwBC,IAAI,CAACC,GAAL,CAAS,IAAT,EAAejC,IAAI,CAACkC,KAAL,CAAW,GAAX,EAAgBV,MAAhB,GAAuB,GAAvB,GAA2B,KAA1C,CAAxB,EAA0EW,OAA1E,CAAkF,GAAlF,EAAuF,YAAM;MACzFV,KAAK,CAACd,MAAN;MACAK,SAAS,GAAG,KAAZ;IACH,CAHD;IAIAjB,SAAS,CAACC,IAAD,EAAO,GAAP,CAAT;EACH;AACJ,CAdD,EAcG,GAdH;AAgBAsB,MAAM,CAACC,WAAP,CAAmB,YAAM;EACrB,IAAG,CAACP,SAAD,IAAcD,kBAAkB,CAACS,MAAnB,GAA4B,CAA7C,EAAgD;IAC5C,IAAIxB,IAAI,GAAGe,kBAAkB,CAACY,GAAnB,EAAX;IACA5B,SAAS,CAACC,IAAD,EAAO,GAAP,CAAT;EACH;AACJ,CALD,EAKG,GALH;AAOAiB,MAAM,CAACE,EAAP,CAAU,QAAV,EAAoB,UAASC,GAAT,EAAc;EAC9BgB,QAAQ,CAACC,MAAT;AACH,CAFD","file":"tts.9dd75304.js","sourceRoot":"..\\client","sourcesContent":["function playAudio(text, volume) {\r\n    let audio = document.createElement(\"audio\");\r\n\r\n    //audio.setAttribute(\"src\", \"https://api.streamelements.com/kappa/v2/speech?voice=Joey&text=\"+text);\r\n    audio.setAttribute(\"src\", \"https://api.streamelements.com/kappa/v2/speech?voice=de-DE-Wavenet-A&text=\"+text);\r\n    audio.setAttribute(\"preload\", \"auto\");\r\n    audio.volume = volume;\r\n    audio.autoplay = true;\r\n\r\n    audio.addEventListener('ended', function() {\r\n        audio.pause();\r\n        audio.removeAttribute('src');\r\n        audio.load();\r\n        audio.remove();\r\n    });\r\n\r\n    document.getElementById(\"root\").appendChild(audio);\r\n}\r\n\r\nlet messageQueue = [];\r\nlet messageQueueNoText = [];\r\nlet isShowing = false;\r\n\r\nvar socket = io();\r\nsocket.on('bot.say', function(msg) {\r\n    messageQueue.push(msg);\r\n});\r\nsocket.on('bot.say.notext', function(msg) {\r\n    messageQueueNoText.push(msg);\r\n});\r\n\r\nwindow.setInterval(() => {\r\n    if(!isShowing && messageQueue.length > 0) {\r\n        isShowing = true;\r\n        let $text = $('<p></p>');\r\n        let text = messageQueue.pop();\r\n        $text.text(text);\r\n        $text.hide();\r\n        $('#chat-wrapper').append($text);\r\n        $text.fadeIn(200).delay(Math.max(3000, text.split(' ').length/130*60000)).fadeOut(200, () => {\r\n            $text.remove();\r\n            isShowing = false;\r\n        });\r\n        playAudio(text, 0.5);\r\n    }\r\n}, 500)\r\n\r\nwindow.setInterval(() => {\r\n    if(!isShowing && messageQueueNoText.length > 0) {\r\n        let text = messageQueueNoText.pop();\r\n        playAudio(text, 0.5);\r\n    }\r\n}, 500)\r\n\r\nsocket.on('reload', function(msg) {\r\n    location.reload();\r\n});"]}